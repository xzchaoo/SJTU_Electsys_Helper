# 选课Helper #

## 介绍 ##
SJTU一共有3轮选课, 第一轮是海选, 每门开课接受任意数量的学生, 然后最后只保留一定量的学生; 第二轮是抢选, 只要有开课人数还不足就可以选; 第三轮选课, 只能选不能退.

## 用途 ##
对于第一轮, 用途不太大, 只能用于列出各种课程和当前的选课人数.
对于第二轮, 用途最大, 捡漏就趁现在了.
对于第三轮, 由于只能选不能退, 因此危险性较大, 慎重慎重.

## 思路 ##
每门开课有一个bsid唯一标识. 通过下面2种方法可以获取开课的信息, 并且没有频率限制(不会因为访问速度太快而被禁止). 
在抢课阶段, http://electsys.sjtu.edu.cn/edu/lesson/viewLessonArrangeDetail.aspx?bsid=? 允许访问, 通过这个页面可以抓取到关于这次开课的教师, 当前人数, 最大人数, 上课时间 等信息.
在任意阶段, 通过 http://electsys.sjtu.edu.cn/edu/lesson/viewLessonArrangeDetail2.aspx?bsid=? 可以访问到开课的信息, 并且比上面那个更详细一点.

因此我们只需要实现准备好要监控的bsid, 然后不断刷新这个页面就可以获得各个开课的信息了. 接下来要做的只是将获取到的信息展示出来.

对于大部分人, 要监控的bsid集合 = 该学期的所有类型的开课的bsid(各种通识课+各种任选课+各种...)
对于少部分人, 要监控的bsid集合 = 手动指定的bsid(即只监控某几门开课)

## 展示 ##
可以通过 通识课(人文,社会,自然科学) 任选课(开课院系) 等指标来筛选要显示的课程.
通过时间筛选的话, 可能会比较麻烦一点, 不过应该也是可以实现的.


### 如何获取开课的bsid ###
这个还是比较简单的, 基本上手动看一下url即可

### 如何批量获取开课的bsid ###
#### 策略1 ####
模拟手动选课的过程, 使用js脚本, 拼凑出url, 通过ajax获得页面, 然后抓取信息.
**优点** : 可以每门课程的类型(通选课, 任选课 ...)
**缺点** :
1. 每一步的操作都有频率限制, 太快的话会被服务器禁止.
2. 有的操作是post操作, 而post必须要带一些参数, 如果不带的话会被认为是非法请求. 这些参数必须从发出操作所在的页面进行获取.
3. 很有可能要分别对 通识课 任选课 等 编写处理代码, 以为它们的开课获取方式不相同.
4. 要进行这些操作必须在开放选课期间, 建议在模拟选课期间将这些数据全部抓取下来. 然后在选课期间世界使用抓取下来的数据以提高反应速度.

#### 策略2 ####
总的来说, bsid是递增的, 所以完全有可能通过大范围的扫描扫除所有开课.
比如, 扫描 http://electsys.sjtu.edu.cn/edu/lesson/viewLessonArrangeDetail2.aspx?bsid=1001 到 http://electsys.sjtu.edu.cn/edu/lesson/viewLessonArrangeDetail2.aspx?bsid=2000 , 这1000个开课的信息. 由于这个url没有频率限制, 因此速度非常快. 然后通过开课年份和学期 进行筛选
**缺点:** 会扫描到一堆乱七八糟的开课, 有的开课根本是没有开, 但是依旧有信息. 并且比较难反向推出这个开课的类型是通选课, 任选课 还是其他的什么.